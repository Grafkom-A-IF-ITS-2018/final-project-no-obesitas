<!DOCTYPE html>

<html>

<head>
    <title>Ini juga keren</title>
    <script src="libs/three.min.js"></script>
    <script src="libs/dat.gui.min.js"></script>
    <script src="libs/WebVR.js"></script>
    <script src="libs/PointerLockControls.js"></script>
    <script src="libs/OrbitControls.js"></script>
    <script src="libs/OBJLoader.js"></script>
    <script src="libs/TextureLoader.js"></script>
    <script src="libs/MeshBasicMaterial.js"></script>
    <script src="libs/FBXLoader.js"></script>
    <script src="libs/inflate.min.js"></script>
    <script src="libs/MTLLoader.js"></script>

    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000000;
        }
    </style>
</head>

<body>
    <script>
        var renderer = new THREE.WebGLRenderer({ 
            antialias: true 
        });
        renderer.setPixelRatio(window.devicePixelRatio);
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.vr.enabled = true;

        document.body.appendChild(renderer.domElement);
        document.body.appendChild(WEBVR.createButton(renderer, { 
                frameOfReferenceType: 'eye-level'
            })
        );
        
        var scene = new THREE.Scene();
        scene.background = new THREE.Color(0x000000);

        var light = new THREE.HemisphereLight(0xfff0f0, 0x606066);
        light.position.set(1, 1, 1);
        scene.add(light);

        var spaceCraft = new THREE.Object3D();
        scene.add(spaceCraft);

        var camera = new THREE.PerspectiveCamera(40, window.innerWidth / window.innerHeight, 0.1, 500);
        spaceCraft.add(camera);
        
        var greenMaterial = new THREE.MeshBasicMaterial({
                color: 0x32cb00
            });
        var blueMaterial = new THREE.MeshBasicMaterial({
            color: 0x004ecb
        });
        var particleMaterial = new THREE.MeshBasicMaterial({
            color: 0xffff00
        });

        var particleGeometry = new THREE.BoxGeometry(300, 300, 300, 10, 10, 10);
        var sphere = new THREE.Mesh(particleGeometry, particleMaterial);
        var materialCloud = new THREE.PointsMaterial({
            color: 0xffffff,
            size: 5,
            transparent: true
        });

        cloud = new THREE.Points(particleGeometry, materialCloud);
        cloud.sortParticles = true;
        createWireframe(particleGeometry);
        //scene.add(cloud);

        var planeKananAtasGeometry = new THREE.CylinderGeometry(25, 25, 2, 6);
        planeKananAtasGeometry.translate(25, 0, -40);
        var planeKananAtasMesh = new THREE.Mesh(planeKananAtasGeometry, greenMaterial);
        scene.add(planeKananAtasMesh);
        createWireframe(planeKananAtasGeometry);

        var planeKiriAtasGeometry = new THREE.CylinderGeometry(25, 25, 2, 6);
        planeKiriAtasGeometry.translate(-25, 0, -40);
        var planeKiriAtasMesh = new THREE.Mesh(planeKiriAtasGeometry, greenMaterial);
        scene.add(planeKiriAtasMesh);
        createWireframe(planeKiriAtasGeometry);

        var planeKiriTengahGeometry = new THREE.CylinderGeometry(25, 25, 2, 6);
        planeKiriTengahGeometry.translate(-50, 0, 0);
        var planeKiriTengahMesh = new THREE.Mesh(planeKiriTengahGeometry, greenMaterial);
        scene.add(planeKiriTengahMesh);
        createWireframe(planeKiriTengahGeometry);

        var planeTengahGeometry = new THREE.CylinderGeometry(25, 25, 2, 6);
        planeTengahGeometry.translate(0, 0, 0);
        var planeTengahMesh = new THREE.Mesh(planeTengahGeometry, blueMaterial);
        scene.add(planeTengahMesh);
        createWireframe(planeTengahGeometry);

        var planeKananTengahGeometry = new THREE.CylinderGeometry(25, 25, 2, 6);
        planeKananTengahGeometry.translate(50, 0, 0);
        var planeKananTengahMesh = new THREE.Mesh(planeKananTengahGeometry, greenMaterial);
        scene.add(planeKananTengahMesh);
        createWireframe(planeKananTengahGeometry);

        var planeKananBawahGeometry = new THREE.CylinderGeometry(25, 25, 2, 6);
        planeKananBawahGeometry.translate(25, 0, 40);
        var planeKananBawahMesh = new THREE.Mesh(planeKananBawahGeometry, greenMaterial);
        scene.add(planeKananBawahMesh);
        createWireframe(planeKananBawahGeometry);

        var planeKiriBawahGeometry = new THREE.CylinderGeometry(25, 25, 2, 6);
        planeKiriBawahGeometry.translate(-25, 0, 40);
        var planeKiriBawahMesh = new THREE.Mesh(planeKiriBawahGeometry, greenMaterial);
        scene.add(planeKiriBawahMesh);
        createWireframe(planeKiriBawahGeometry);

        function createWireframe(geometry) {
            var wireframe = new THREE.WireframeGeometry(geometry);
            var material = new THREE.LineBasicMaterial( {
                color: 0xffffff,
                linewidth: 1,
                linecap: 'round',
                linejoin:  'round'
            });
            var line = new THREE.LineSegments(wireframe, material);
            line.material.depthTest = false;
            line.material.opacity = 0.25;
            line.material.transparent = true;
            scene.add(line); 
        }

        /*var mesh = new THREE.Mesh( geometry, material );
        scene.add( mesh );
        var geometry = new SkyGeometry();
        var material = new THREE.MeshBasicMaterial( { color: 0xffffff } );
        var mesh = new THREE.Mesh( geometry, material );
        scene.add( mesh );*/

        var PI2 = Math.PI * 2;
        var curve = function () {
            var vector = new THREE.Vector3();
            var vector2 = new THREE.Vector3();
            
            return {
                getPointAt: function (t) {
                    t = t * PI2;
                    var x = Math.sin(t * 3) * Math.cos(t * 4) * 50;
                    var y = Math.sin(t * 10) * 2 + Math.cos(t * 17) * 2 + 5;
                    var z = Math.sin(t) * Math.sin(t * 4) * 50;
                    return vector.set(x, y, z).multiplyScalar(2);
                },
                getTangentAt: function (t) {
                    var delta = 0.0001;
                    var t1 = Math.max(0, t - delta);
                    var t2 = Math.min(1, t + delta);

                    return vector2.copy(this.getPointAt(t2))
                        .sub(this.getPointAt(t1)).normalize();
                }
            };
        }();

        /*var geometry = new RollerCoasterGeometry( curve, 1500 );
        var material = new THREE.MeshPhongMaterial( {
            vertexColors: THREE.VertexColors
        } );
        var mesh = new THREE.Mesh( geometry, material );
        scene.add( mesh );
        var geometry = new RollerCoasterLiftersGeometry( curve, 100 );
        var material = new THREE.MeshPhongMaterial();
        var mesh = new THREE.Mesh( geometry, material );
        mesh.position.y = 0.1;
        scene.add( mesh );
        var geometry = new RollerCoasterShadowGeometry( curve, 500 );
        var material = new THREE.MeshBasicMaterial( {
            color: 0x305000, depthWrite: false, transparent: true
        } );*/

        window.addEventListener('resize', onWindowResize, false);
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize( window.innerWidth, window.innerHeight );
        }
        
        var position = new THREE.Vector3();
        var tangent = new THREE.Vector3();
        var lookAt = new THREE.Vector3();
        var velocity = 0;
        var progress = 0;
        var prevTime = performance.now();

        function render() {
            var time = performance.now();
            var delta = time - prevTime;
            progress += velocity;
            progress = progress % 1;
            position.copy(curve.getPointAt(progress));
            position.y += 0.3;
            spaceCraft.position.copy( position );
            tangent.copy( curve.getTangentAt( progress ) );
            velocity -= tangent.y * 0.0000001 * delta;
            velocity = Math.max( 0.00004, Math.min( 0.0002, velocity ) );
            spaceCraft.lookAt( lookAt.copy( position ).sub( tangent ) );

            renderer.render( scene, camera );
            prevTime = time;
        }
        /*SNOW*/
            // var texture = new THREE.TextureLoader().load('assets/PineTexture.png');
            // var material = new THREE.MeshBasicMaterial({map:texture});

            // var objLoader = new THREE.OBJLoader();
            // objLoader.load('assets/PineTree1Snowy.obj', function(object){
            //     object.scale.x = 10;
            //     object.scale.y = 10;
            //     object.scale.z = 10;
            //     object.position.x -= 30;
            //     object.position.z += 30;
            //     object.traverse(function(node){
            //         if(node.isMesh) node.material = material;
            //     });

            //     scene.add(object);
            // });
            // objLoader.load('assets/PineTree2Snowy.obj', function(object){
            //     object.scale.x = 10;
            //     object.scale.y = 10;
            //     object.scale.z = 10;
            //     object.position.x -= 30;
            //     object.position.z -= 30;
            //     object.traverse(function(node){
            //         if(node.isMesh) node.material = material;
            //     });

            //     scene.add(object);
            // });
            
            /*SUMMER*/
            // var texture = new THREE.TextureLoader().load('assets/EvergreenTexture.png');
            // var material = new THREE.MeshBasicMaterial({map:texture});

            // var objLoader = new THREE.OBJLoader();
            // objLoader.load('assets/PineTree2.obj', function(object){
            //     object.scale.x = 10;
            //     object.scale.y = 10;
            //     object.scale.z = 10;
            //     object.position.x -= 30;
            //     object.position.z += 30;
            //     object.traverse(function(node){
            //         if(node.isMesh) node.material = material;
            //     });

            //     scene.add(object);
            // });
            // objLoader.load('assets/PineTree3.obj', function(object){
            //     object.scale.x = 10;
            //     object.scale.y = 10;
            //     object.scale.z = 10;
            //     object.position.x -= 30;
            //     object.position.z -= 30;
            //     object.traverse(function(node){
            //         if(node.isMesh) node.material = material;
            //     });

            //     scene.add(object);
            // });

            var texture = new THREE.TextureLoader().load('assets/AlienTreeTexture.png');
            var material = new THREE.MeshBasicMaterial({map:texture});

            var objLoader = new THREE.OBJLoader();
            objLoader.load('assets/PineTree1.obj', function(object){
                object.scale.x = 10;
                object.scale.y = 10;
                object.scale.z = 10;
                object.position.x -= 30;
                object.position.z += 30;
                object.traverse(function(node){
                    if(node.isMesh) node.material = material;
                });

                scene.add(object);
            });
            objLoader.load('assets/PineTree3.obj', function(object){
                object.scale.x = 10;
                object.scale.y = 10;
                object.scale.z = 10;
                object.position.x -= 30;
                object.position.z -= 30;
                object.traverse(function(node){
                    if(node.isMesh) node.material = material;
                });

                scene.add(object);
            });

        renderer.setAnimationLoop( render );
    </script>
</body>

</html>